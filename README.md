# CI/CD Workflows Documentation

## Overview

This repository contains the necessary configuration to set up **Continuous Integration (CI)** and **Continuous Deployment (CD)** for a Spring Boot application using **GitHub Actions** and **Heroku**.

The CI workflow ensures that the code is automatically tested and built upon every push to the main branch, while the CD workflow deploys the application to Heroku after a successful build and test.

## Project Structure

- **.github/workflows/main.yml**: GitHub Actions CI/CD workflow file.
- **src/main/resources/application.properties**: Application configuration for database connection.
- **Procfile**: Configuration file for Heroku to specify how to run the application.
- **docs/README.md**: Documentation for the project and workflows.

## Workflows

### CI Workflow

The CI workflow is responsible for building, testing, and creating artifacts of the application. It runs on every push to the `main` branch.

#### CI Workflow File (`.github/workflows/main.yml`):

```yaml
name: CI Workflow

on:
  push:
    branches:
      - main

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Set up JDK 11
        uses: actions/setup-java@v2
        with:
          java-version: '11'

      - name: Install dependencies
        run: ./mvnw install

      - name: Run tests
        run: ./mvnw test

      - name: Generate build artifacts
        run: ./mvnw package
```

#### CI Workflow Steps:

1. **Checkout code**: Clones the repository so that the workflow can access the project files.
2. **Set up JDK 11**: Configures Java 11 for the environment.
3. **Install dependencies**: Installs the necessary Maven dependencies.
4. **Run tests**: Executes the unit tests to ensure the application is functioning as expected.
5. **Generate build artifacts**: Packages the application into a deployable JAR file.

### CD Workflow

The CD workflow extends the CI workflow by deploying the built application to **Heroku** after successful testing.

#### CD Workflow File (`.github/workflows/main.yml`):

```yaml
name: CD Workflow

on:
  push:
    branches:
      - main

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Set up JDK 11
        uses: actions/setup-java@v2
        with:
          java-version: '11'

      - name: Install dependencies
        run: ./mvnw install

      - name: Run tests
        run: ./mvnw test

      - name: Generate build artifacts
        run: ./mvnw package

      - name: Deploy to Heroku
        uses: akhileshns/heroku-deploy@v3.12.12
        with:
          heroku_api_key: ${{ secrets.HEROKU_API_KEY }}
          heroku_app_name: "your-heroku-app-name"
          heroku_email: "your-email@example.com"
```

#### CD Workflow Steps:

1. **Checkout code**: Clones the repository to access the project files.
2. **Set up JDK 11**: Configures Java 11 for the environment.
3. **Install dependencies**: Installs Maven dependencies.
4. **Run tests**: Executes the tests.
5. **Generate build artifacts**: Packages the application.
6. **Deploy to Heroku**: Deploys the built application to Heroku using credentials stored in GitHub secrets.

## Configuration Files

### Application Properties

The `application.properties` file is used to configure the database connection and other settings.

```properties
spring.datasource.url=${JDBC_DATABASE_URL}
spring.datasource.username=${JDBC_DATABASE_USERNAME}
spring.datasource.password=${JDBC_DATABASE_PASSWORD}
spring.datasource.driver-class-name=org.sqlite.JDBC
```

- The properties for `spring.datasource.url`, `username`, and `password` are set using environment variables provided by Heroku.
- This setup allows the application to connect to the **Heroku Postgres** database.

### Procfile

The **Procfile** tells Heroku how to run the Spring Boot application:

```
web: java -Dserver.port=$PORT -jar target/your-app-name.jar
```

- Replace `your-app-name.jar` with the correct JAR file name generated by Maven.

## GitHub Secrets

The **Heroku API Key** must be securely stored in GitHub Secrets for deployment:

- **HEROKU_API_KEY**: Go to your GitHub repository > **Settings** > **Secrets and variables** > **Actions**. Add a new secret named `HEROKU_API_KEY` and paste your Heroku API Key.

## Testing and Validation

To test and validate the workflows:

1. **Commit and Push Changes**: Commit and push the updated files to your repository. This will trigger the GitHub Actions workflows.
2. **Validate CI Workflow**: Check the **Actions tab** in GitHub to ensure that the CI workflow completes successfully, with all tests passing.
3. **Validate CD Workflow**: Ensure the CD workflow deploys the application to Heroku. If youâ€™re not deploying the app, document the workflow process thoroughly.

## Documentation Summary

- **CI Workflow**: Handles building, testing, and packaging the application.
- **CD Workflow**: Deploys the built application to Heroku.
- **Configuration Files**: Ensure the correct setup for deployment (`application.properties` and `Procfile`).
- **GitHub Secrets**: Securely store sensitive information like `HEROKU_API_KEY`.

### Screenshots (Optional)

Include screenshots of successful workflow runs or the **Actions tab** in GitHub showing each workflow step.

## Notes

- **Assumptions**: This documentation assumes that the database connection is properly set up using the `application.properties` file and environment variables provided by Heroku.
- **Challenges**: Not deploying to Heroku means that the actual CD process was not validated live. This workflow setup is, however, configured as per best practices.